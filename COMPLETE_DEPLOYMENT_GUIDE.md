# Noryx Premium VPN - –ü–û–õ–ù–´–ô –ì–ê–ô–î –†–ê–ó–í–ï–†–¢–ö–ò –ò –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

> **–≠—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–º –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–∑–≤–µ—Ä—Ç–∫–∏ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Noryx Premium VPN –≤ production —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é, —É–º–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π Connect –∏ –≤—Å–µ–º–∏ –º–æ–¥—É–ª—è–º–∏.**

–û–≥–ª–∞–≤–ª–µ–Ω–∏–µ:
- [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
- [–ß–∞—Å—Ç—å 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞](#—á–∞—Å—Ç—å-1-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-—Å–µ—Ä–≤–µ—Ä–∞)
- [–ß–∞—Å—Ç—å 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π](#—á–∞—Å—Ç—å-2-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- [–ß–∞—Å—Ç—å 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#—á–∞—Å—Ç—å-3-–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–ß–∞—Å—Ç—å 4: –†–∞–∑–≤–µ—Ä—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#—á–∞—Å—Ç—å-4-—Ä–∞–∑–≤–µ—Ä—Ç–∫–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–ß–∞—Å—Ç—å 5: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx](#—á–∞—Å—Ç—å-5-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-nginx)
- [–ß–∞—Å—Ç—å 6: SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç](#—á–∞—Å—Ç—å-6-ssl-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
- [–ß–∞—Å—Ç—å 7: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#—á–∞—Å—Ç—å-7-–∑–∞–ø—É—Å–∫-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–ß–∞—Å—Ç—å 8: –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)](#—á–∞—Å—Ç—å-8-–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å-–ø–æ–ª–Ω–æ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–ß–∞—Å—Ç—å 9: –£–º–Ω–∞—è –∫–Ω–æ–ø–∫–∞ Connect](#—á–∞—Å—Ç—å-9-—É–º–Ω–∞—è-–∫–Ω–æ–ø–∫–∞-connect)
- [–ß–∞—Å—Ç—å 10: –ú–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#—á–∞—Å—Ç—å-10-–º–æ–¥—É–ª–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–ß–∞—Å—Ç—å 11: API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#—á–∞—Å—Ç—å-11-api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
- [–ß–∞—Å—Ç—å 12: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#—á–∞—Å—Ç—å-12-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [–ß–∞—Å—Ç—å 13: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#—á–∞—Å—Ç—å-13-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [–ß–∞—Å—Ç—å 14: –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—á–∞—Å—Ç—å-14-—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

**Noryx Premium VPN** - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN —Å:

- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –ø–æ–¥–ø–∏—Å–∫–∞–º–∏, —Å—Ç—Ä–∞–Ω–∞–º–∏
- **–£–º–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π Connect** –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (iOS, Android, Desktop) –∏ –æ—Ç–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –≤ –Ω—É–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- **–ú–æ–¥—É–ª—è–º–∏** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å 3X-UI, QR –∫–æ–¥–∞–º–∏, –ø–ª–∞—Ç—Ñ–æ—Ä–º-–¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–º, —Ç–æ–∫–µ–Ω-—Å–µ—Ä–≤–∏—Å–æ–º
- **REST API** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- **–õ–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å 3X-UI** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN —Å–µ—Ä–≤–µ—Ä–æ–º

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  NORYX VPN –°–ò–°–¢–ï–ú–ê                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                         ‚îÇ
‚îÇ  [1] NGINX Reverse Proxy (–ü–æ—Ä—Ç 80/443)                 ‚îÇ
‚îÇ          ‚Üì                                              ‚îÇ
‚îÇ  [2] Node.js Express Server (–ü–æ—Ä—Ç 3000)                ‚îÇ
‚îÇ          ‚îú‚îÄ‚îÄ /api/vpn/* - –£–º–Ω–∞—è –∫–Ω–æ–ø–∫–∞ Connect        ‚îÇ
‚îÇ          ‚îú‚îÄ‚îÄ /api/admin/* - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å              ‚îÇ
‚îÇ          ‚îî‚îÄ‚îÄ /admin.html - HTML –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å          ‚îÇ
‚îÇ          ‚Üì                                              ‚îÇ
‚îÇ  [3] PostgreSQL Database                               ‚îÇ
‚îÇ          ‚îî‚îÄ‚îÄ –¢–∞–±–ª–∏—Ü—ã: users, subscriptions, logs, etc  ‚îÇ
‚îÇ          ‚Üì                                              ‚îÇ
‚îÇ  [4] 3X-UI Server (–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)                         ‚îÇ
‚îÇ          ‚îî‚îÄ‚îÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ VPN –∫–ª–∏–µ–Ω—Ç–∞–º–∏                 ‚îÇ
‚îÇ                                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

# –ß–ê–°–¢–¨ 1: –ü–û–î–ì–û–¢–û–í–ö–ê –°–ï–†–í–ï–†–ê

## 1.1 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

```
–û–°:           Ubuntu 22.04 LTS –∏–ª–∏ Debian 12 (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)
RAM:          4 GB –º–∏–Ω–∏–º—É–º (–¥–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8 GB)
CPU:          2+ —è–¥—Ä–∞
–î–∏—Å–∫:         50 GB SSD
–î–æ–º–µ–Ω:        example.com (–Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞)
–í—Ö–æ–¥—è—â–∏–µ:     SSH (22), HTTP (80), HTTPS (443)
```

## 1.2 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –ø–æ SSH
ssh root@YOUR_SERVER_IP

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get install -y curl wget git nano htop net-tools ufw

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
sudo locale-gen en_US.UTF-8
```

## 1.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞ (UFW)

```bash
# –†–∞–∑—Ä–µ—à–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp          # SSH
sudo ufw allow 80/tcp          # HTTP
sudo ufw allow 443/tcp         # HTTPS

# –í–∫–ª—é—á–∏—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª
sudo ufw enable
sudo ufw status

# –í—ã—Ö–æ–¥: Status: active
```

---

# –ß–ê–°–¢–¨ 2: –£–°–¢–ê–ù–û–í–ö–ê –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô

## 2.1 Node.js 20.x

```bash
# –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π NodeSource
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js
sudo apt-get install -y nodejs

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏
node --version    # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v20.x.x
npm --version     # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 10.x.x
```

## 2.2 PostgreSQL 15

```bash
# –î–æ–±–∞–≤—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π PostgreSQL
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL
sudo apt-get update
sudo apt-get install -y postgresql-15 postgresql-contrib-15

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl start postgresql
sudo systemctl enable postgresql
sudo systemctl status postgresql

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é
psql --version  # psql (PostgreSQL) 15.x
```

## 2.3 PM2 (Process Manager)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PM2 –≥–ª–æ–±–∞–ª—å–Ω–æ
sudo npm install -g pm2

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 startup systemd -u $USER --hp /home/$USER
pm2 save

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
pm2 --version
```

## 2.4 Nginx

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Nginx
sudo apt-get install -y nginx

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl start nginx
sudo systemctl enable nginx
sudo systemctl status nginx
```

## 2.5 Certbot (–¥–ª—è Let's Encrypt SSL)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot
sudo apt-get install -y certbot python3-certbot-nginx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ
certbot --version
```

---

# –ß–ê–°–¢–¨ 3: –ë–ê–ó–ê –î–ê–ù–ù–´–•

## 3.1 –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
sudo -u postgres psql

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –≤ psql:

CREATE DATABASE noryx_vpn ENCODING 'UTF8';

CREATE USER noryx_admin WITH ENCRYPTED PASSWORD 'YOUR_VERY_STRONG_PASSWORD_HERE';

ALTER ROLE noryx_admin SET client_encoding TO 'utf8';
ALTER ROLE noryx_admin SET default_transaction_isolation TO 'read committed';
ALTER ROLE noryx_admin SET timezone TO 'UTC';

GRANT ALL PRIVILEGES ON DATABASE noryx_vpn TO noryx_admin;
GRANT USAGE ON SCHEMA public TO noryx_admin;
GRANT CREATE ON SCHEMA public TO noryx_admin;

ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT SELECT, INSERT, UPDATE, DELETE ON TABLES TO noryx_admin;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT EXECUTE ON FUNCTIONS TO noryx_admin;

# –í—ã–π–¥–∏—Ç–µ –∏–∑ psql
\q
```

## 3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
psql -h localhost -U noryx_admin -d noryx_vpn -c "SELECT VERSION();"

# –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å
# –î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏ –≤–µ—Ä—Å–∏—é PostgreSQL
```

## 3.3 –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ npm run init-db)

```sql
-- USERS: –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255),
  is_admin BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- SUBSCRIPTIONS: –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS subscriptions (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  plan_type VARCHAR(50) DEFAULT 'basic',
  status VARCHAR(50) DEFAULT 'active',
  x3ui_client_uuid VARCHAR(255),
  x3ui_client_email VARCHAR(255),
  x3ui_inbound_id INTEGER,
  started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  expires_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- VPN_KEYS: –ö–ª—é—á–∏ VPN (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
CREATE TABLE IF NOT EXISTS vpn_keys (
  id SERIAL PRIMARY KEY,
  subscription_id INTEGER NOT NULL REFERENCES subscriptions(id) ON DELETE CASCADE,
  x3ui_client_id VARCHAR(255),
  x3ui_inbound_id INTEGER,
  x3ui_inbound_tag VARCHAR(100),
  country_code VARCHAR(2),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(subscription_id)
);

-- CONNECTION_LOGS: –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
CREATE TABLE IF NOT EXISTS connection_logs (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  platform VARCHAR(50),
  connection_type VARCHAR(50),
  country_code VARCHAR(2),
  connected_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- AVAILABLE_COUNTRIES: –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
CREATE TABLE IF NOT EXISTS available_countries (
  id SERIAL PRIMARY KEY,
  country_code VARCHAR(2) UNIQUE NOT NULL,
  country_name VARCHAR(100),
  flag_emoji VARCHAR(10),
  is_available BOOLEAN DEFAULT true,
  priority INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
CREATE INDEX IF NOT EXISTS idx_subscriptions_user_id ON subscriptions(user_id);
CREATE INDEX IF NOT EXISTS idx_subscriptions_status ON subscriptions(status);
CREATE INDEX IF NOT EXISTS idx_vpn_keys_subscription_id ON vpn_keys(subscription_id);
CREATE INDEX IF NOT EXISTS idx_connection_logs_user_id ON connection_logs(user_id);
CREATE INDEX IF NOT EXISTS idx_connection_logs_connected_at ON connection_logs(connected_at);
```

---

# –ß–ê–°–¢–¨ 4: –†–ê–ó–í–ï–†–¢–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

## 4.1 –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–¥–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo mkdir -p /opt/noryx-vpn
sudo chown $USER:$USER /opt/noryx-vpn

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd /opt/noryx-vpn

# –ï—Å–ª–∏ –µ—Å—Ç—å git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <YOUR_REPOSITORY_URL> .

# –ò–ª–∏ –µ—Å–ª–∏ –µ—Å—Ç—å –∞—Ä—Ö–∏–≤
unzip noryx-vpn.zip
cd noryx-vpn
```

## 4.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π npm

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/noryx-vpn

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å
npm list --depth=0

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
# ‚îú‚îÄ‚îÄ axios
# ‚îú‚îÄ‚îÄ cors
# ‚îú‚îÄ‚îÄ dotenv
# ‚îú‚îÄ‚îÄ express
# ‚îú‚îÄ‚îÄ helmet
# ‚îú‚îÄ‚îÄ jsonwebtoken
# ‚îú‚îÄ‚îÄ pg
# ‚îî‚îÄ‚îÄ qrcode
```

## 4.3 –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ .env

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª
nano .env
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ .env –¥–ª—è production:**

```env
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# PRODUCTION –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø NORYX VPN
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò
PORT=3000
NODE_ENV=production
HOST=127.0.0.1
BASE_URL=https://example.com

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –ë–ê–ó–ê –î–ê–ù–ù–´–• POSTGRESQL
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

DB_HOST=localhost
DB_PORT=5432
DB_NAME=noryx_vpn
DB_USER=noryx_admin
DB_PASSWORD=YOUR_VERY_STRONG_PASSWORD_HERE
DB_POOL_SIZE=20
DB_IDLE_TIMEOUT=30000

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –¢–û–ö–ï–ù–´
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

# –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–º–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤)
ADMIN_PASSWORD=your_very_strong_admin_password_here

# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–æ–π: openssl rand -base64 32
JWT_SECRET=GENERATE_WITH_openssl_rand_-base64_32
HMAC_SECRET=GENERATE_WITH_openssl_rand_-base64_32

TOKEN_EXPIRY_SECONDS=300
JWT_EXPIRES_IN=7d

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° 3X-UI (VPN SERVER)
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

# –ê–¥—Ä–µ—Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ 3X-UI –Ω–∞ –¥—Ä—É–≥–æ–º VPS
X3UI_API_URL=https://3xui-panel.example.com:2053
X3UI_USERNAME=admin_username
X3UI_PASSWORD=admin_password
X3UI_TIMEOUT=30000

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# CORS –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

# –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ALLOWED_ORIGINS=https://example.com,https://app.example.com,https://www.example.com

# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
# –õ–û–ì–ò–†–û–í–ê–ù–ò–ï
# ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

LOG_LEVEL=info
LOG_FORMAT=combined
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤:

```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ JWT_SECRET
echo "JWT_SECRET=$(openssl rand -base64 32)"

# –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ HMAC_SECRET
echo "HMAC_SECRET=$(openssl rand -base64 32)"

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ .env —Ñ–∞–π–ª
```

## 4.4 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/noryx-vpn

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å—Ö–µ–º—É –ë–î (—Å–æ–∑–¥–∞—Å—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã)
npm run init-db

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
psql -U noryx_admin -d noryx_vpn -c "\dt"

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
#              List of relations
# Schema |       Name        | Type  | Owner
#--------+-------------------+-------+----------
# public | available_countries | table | noryx_admin
# public | connection_logs   | table | noryx_admin
# public | subscriptions     | table | noryx_admin
# public | users             | table | noryx_admin
# public | vpn_keys          | table | noryx_admin
```

## 4.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
npm run build

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –±–µ–∑ –æ—à–∏–±–æ–∫
# –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –∏—Å–ø—Ä–∞–≤—å—Ç–µ –∏—Ö –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç–∫–æ–º
```

---

# –ß–ê–°–¢–¨ 5: –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø NGINX

## 5.1 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è Nginx

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥
sudo nano /etc/nginx/sites-available/noryx
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ñ–∏–≥–∞:**

```nginx
# HTTP —Å–µ—Ä–≤–µ—Ä (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS)
server {
    listen 80;
    listen [::]:80;
    server_name example.com www.example.com;

    # –î–ª—è certbot
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    # –†–µ–¥–∏—Ä–µ–∫—Ç –≤—Å–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –Ω–∞ HTTPS
    location / {
        return 301 https://$server_name$request_uri;
    }
}

# HTTPS —Å–µ—Ä–≤–µ—Ä (–æ—Å–Ω–æ–≤–Ω–æ–π)
server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name example.com www.example.com;

    # SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢–´ (Let's Encrypt)
    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    # –ù–ê–°–¢–†–û–ô–ö–ò SSL
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;

    # SECURITY HEADERS (–í–ê–ñ–ù–û!)
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "DENY" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;

    # –ù–ê–°–¢–†–û–ô–ö–ò PROXY
    client_max_body_size 20M;
    proxy_read_timeout 300s;
    proxy_connect_timeout 300s;

    # –õ–û–ì–ò
    access_log /var/log/nginx/noryx_access.log;
    error_log /var/log/nginx/noryx_error.log;

    # –û–°–ù–û–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï
    location / {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;

        # Headers –¥–ª—è proxy
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;

        # Timeouts
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ï –§–ê–ô–õ–´ (—Å –∫—ç—à–µ–º)
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        proxy_pass http://127.0.0.1:3000;
        proxy_cache_valid 200 30d;
        expires 30d;
    }
}
```

## 5.2 –í–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞

```bash
# –°–æ–∑–¥–∞–π—Ç–µ symlink –≤ sites-enabled
sudo ln -s /etc/nginx/sites-available/noryx /etc/nginx/sites-enabled/

# –£–¥–∞–ª–∏—Ç–µ default –∫–æ–Ω—Ñ–∏–≥ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
sudo rm /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Nginx
sudo nginx -t

# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
# nginx: configuration file /etc/nginx/nginx.conf test is successful

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
sudo systemctl reload nginx
```

---

# –ß–ê–°–¢–¨ 6: SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢ (Let's Encrypt)

## 6.1 –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

```bash
# –ü–æ–ª—É—á–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Let's Encrypt
sudo certbot certonly --nginx -d example.com -d www.example.com

# –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ:
# 1. –í–≤–µ–¥–∏—Ç–µ email
# 2. –°–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏ (y)
# 3. –í—ã–±–µ—Ä–∏—Ç–µ "No" –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –¥–µ–ª–∏—Ç—å—Å—è email
# 4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç 2 (—Å www –∏ –±–µ–∑ www)

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
sudo ls -la /etc/letsencrypt/live/example.com/

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã:
# - fullchain.pem
# - privkey.pem
```

## 6.2 –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–∞–π–º–µ—Ä –≤–∫–ª—é—á–µ–Ω
sudo systemctl status certbot.timer

# –ï—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω
sudo systemctl enable certbot.timer
sudo systemctl start certbot.timer

# –¢–µ—Å—Ç–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç)
sudo certbot renew --dry-run

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è
sudo certbot certificates
```

---

# –ß–ê–°–¢–¨ 7: –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

## 7.1 –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /opt/noryx-vpn

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
npm start

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:
# üöÄ Noryx Premium VPN Server Started
# üì° Listening on http://0.0.0.0:3000
# üåç Environment: production

# –î–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
```

## 7.2 –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ PM2 (Production)

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PM2
cd /opt/noryx-vpn
pm2 start src/server.js --name noryx --watch

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2
pm2 save

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
pm2 logs noryx --lines 50
```

## 7.3 –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PM2 –Ω–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 startup systemd -u $USER --hp /home/$USER
pm2 save

# –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
```

## 7.4 –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
sudo reboot

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (–ø–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥)
pm2 status     # –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ noryx –∑–∞–ø—É—â–µ–Ω
pm2 logs       # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–∞
```

---

# –ß–ê–°–¢–¨ 8: –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ (–ü–û–õ–ù–û–ï –û–ü–ò–°–ê–ù–ò–ï)

## 8.1 –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

```
URL: https://example.com/admin.html
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **JWT-—Ç–æ–∫–µ–Ω—ã** –∏ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏).

**–ü—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞:**

1. –û—Ç–∫—Ä–æ–π—Ç–µ `https://example.com/admin.html`
2. –í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω-–ø–∞—Ä–æ–ª—å –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `ADMIN_PASSWORD` –≤ `.env`
3. –ù–∞–∂–º–∏—Ç–µ **Login**
4. –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JWT-—Ç–æ–∫–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ localStorage
5. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–æ—Ç —Ç–æ–∫–µ–Ω

**–í–∞–∂–Ω–æ:**
- –≠—Ç–æ **–¥—Ä—É–≥–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**, —á–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ VPN –∞–∫–∫–∞—É–Ω—Ç—ã
- –¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 24 —á–∞—Å–∞, –∑–∞—Ç–µ–º –Ω—É–∂–Ω–æ –∑–∞–Ω–æ–≤–æ –≤–æ–π—Ç–∏
- –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ —Ç–æ–∫–µ–Ω —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ localStorage

**–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–æ –∞–¥–º–∏–Ω-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é:**
‚Üí –ß–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç `–ê–î–ú–ò–ù_–ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø.md`

## 8.2 –î–∏–∑–∞–π–Ω –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∏–º–µ–µ—Ç:

### **–ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (Sidebar)**
- Dashboard
- Users Management
- Subscriptions
- Countries Management
- Connection Logs
- Stats & Analytics

### **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (Dashboard)**

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
- **Total Users** - –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ
- **Active Subscriptions** - –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (–Ω–µ –∏—Å—Ç–µ–∫—à–∏–µ)
- **24h Connections** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
- **Platform Stats** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º (iOS, Android, Desktop)

–ì—Ä–∞—Ñ–∏–∫–∏:
- Top 5 Countries - –¢–û–ü 5 —Å—Ç—Ä–∞–Ω –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- Platform Distribution - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º

## 8.3 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (Users Management)

### –§—É–Ω–∫—Ü–∏–∏:

**–¢–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏:**
- Email
- Total Subscriptions - –í—Å–µ–≥–æ –ø–æ–¥–ø–∏—Å–æ–∫
- Active Subscriptions - –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

**–î–µ–π—Å—Ç–≤–∏—è:**
- –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∏
- –í—ã–¥–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## 8.4 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (Subscriptions)

### –¢–∞–±–ª–∏—Ü–∞ –ø–æ–¥–ø–∏—Å–æ–∫:

```
Email | Plan Type | Status | Expires At | Created At | Actions
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

**RENEW** - –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
```
- –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30)
- –ù–∞–∂–º–∏—Ç–µ "Renew"
- –ü–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–ª–∏—Ç—Å—è –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π
```

**CANCEL** - –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
```
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Cancel"
- –ü–æ–¥–ø–∏—Å–∫–∞ –∏–∑–º–µ–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ "cancelled"
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
```

**GRANT TRIAL** - –í—ã–¥–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
```
- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7)
- –ù–∞–∂–º–∏—Ç–µ "Grant Trial"
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±—É–¥–µ—Ç –≤—ã–¥–∞–Ω–∞ –ø—Ä–æ–±–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
```

## 8.5 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∞–º–∏ (Countries Management)

### –¢–∞–±–ª–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞–Ω:

```
Flag | Country Name | Code | Available | Priority | Actions
```

### –î–µ–π—Å—Ç–≤–∏—è:

**TOGGLE** - –í–∫–ª—é—á–∏—Ç—å/–í—ã–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–∞–Ω—É
```
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Toggle" —Ä—è–¥–æ–º —Å–æ —Å—Ç—Ä–∞–Ω–æ–π
- –°—Ç—Ä–∞–Ω–∞ –∏–∑–º–µ–Ω–∏—Ç —Å—Ç–∞—Ç—É—Å (–¥–æ—Å—Ç—É–ø–Ω–∞ ‚Üî –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π —Å—Ç—Ä–∞–Ω–µ
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** - –í—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, –≤—ã—à–µ –≤ —Å–ø–∏—Å–∫–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

## 8.6 Connection Logs

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:

```
Email | Platform | Connection Type | Country | Connected At
```

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
- **Platform** - iOS, Android, Windows, macOS, Linux
- **Connection Type** - –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥–∞ (QR Code, Deep Link, File)
- **Country** - –°—Ç—Ä–∞–Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **Connected At** - –í—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**–§–∏–ª—å—Ç—Ä—ã:**
- –ü–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
- –ü–æ –¥–∞—Ç–µ
- –ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

## 8.7 Statistics & Analytics

### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

- **Total Users** - –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Active Subscriptions** - –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- **24h Connections** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∑–∞ 24 —á–∞—Å–∞
- **7d Connections** - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∑–∞ 7 –¥–Ω–µ–π
- **Top 5 Countries** - –¢–û–ü 5 —Å—Ç—Ä–∞–Ω –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º
- **Platform Distribution** - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º

---

# –ß–ê–°–¢–¨ 9: –£–ú–ù–ê–Ø –ö–ù–û–ü–ö–ê CONNECT

## 9.1 –ß—Ç–æ —Ç–∞–∫–æ–µ Smart Connect Button?

**Smart Connect Button** - —ç—Ç–æ —É–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ç–æ—Ä–∞—è:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (iOS, Android, Desktop)
2. **–û—Ç–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –≤ –Ω—É–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:**
   - iOS: Deep Link + QR Code
   - Android: Deep Link + QR Code
   - Desktop: File Download (–∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª)

3. **–°–æ–∑–¥–∞–µ—Ç VPN –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3X-UI** –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
4. **–õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Å—Ç—Ä–∞–Ω—É** –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

## 9.2 –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ù–ê–ñ–ò–ú–ê–ï–¢ "CONNECT"                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ü–õ–ê–¢–§–û–†–ú–´ (User-Agent)                  ‚îÇ
‚îÇ     iOS? Android? Desktop?                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. –ü–†–û–í–ï–†–ö–ê –ü–û–î–ü–ò–°–ö–ò                                   ‚îÇ
‚îÇ     –ï—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞?                          ‚îÇ
‚îÇ     –ù–µ –∏—Å—Ç–µ–∫–ª–∞ –ª–∏ –æ–Ω–∞?                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. –°–û–ó–î–ê–ù–ò–ï 3X-UI –ö–õ–ò–ï–ù–¢–ê (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)        ‚îÇ
‚îÇ     UUID: random –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è                           ‚îÇ
‚îÇ     Email: user_123_timestamp@noryx.vpn                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. –ü–û–õ–£–ß–ï–ù–ò–ï –ö–û–ù–§–ò–ì–ê                                   ‚îÇ
‚îÇ     –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ —É 3X-UI –¥–ª—è —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–¢–í–ï–¢–ê                               ‚îÇ
‚îÇ     iOS/Android:  Deep Link + QR Code                   ‚îÇ
‚îÇ     Desktop:      File Download                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  6. –õ–û–ì–ò–†–û–í–ê–ù–ò–ï                                         ‚îÇ
‚îÇ     –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ë–î: –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —Å—Ç—Ä–∞–Ω–∞, –≤—Ä–µ–º—è           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –û–¢–í–ï–¢ –ö–õ–ò–ï–ù–¢–£ –° –ö–û–ù–§–ò–ì–û–ú                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## 9.3 API —ç–Ω–¥–ø–æ–∏–Ω—Ç Smart Connect

```
POST /api/vpn/connect
```

### –ó–∞–ø—Ä–æ—Å:

```json
{
  "userId": 1,
  "countryCode": "auto"
}
```

–∏–ª–∏ —á–µ—Ä–µ–∑ User-Agent (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):

```
User-Agent: Mozilla/5.0 (iPad; U; CPU OS 5_1 like Mac OS X) ...
```

### –û—Ç–≤–µ—Ç –¥–ª—è iOS/Android (QR Code):

```json
{
  "platform": "ios",
  "deliveryFormat": "qr-code",
  "protocol": "vless",
  "countryCode": "us",
  "serverLocation": "3X-UI Inbound: VLESS",
  "qrCode": "data:image/png;base64,iVBORw0KGgoAAAANS...",
  "configLink": "vless://5e0a5e0a5e0a5e0a@3xui.example.com:443?..."
}
```

### –û—Ç–≤–µ—Ç –¥–ª—è Desktop (File Download):

```json
{
  "platform": "windows",
  "deliveryFormat": "file",
  "protocol": "vless",
  "countryCode": "us",
  "serverLocation": "3X-UI Inbound: VLESS",
  "downloadUrl": "/api/vpn/download/eyJhbGciOiJIUzI1NiIs...",
  "expiresIn": 300
}
```

### –û—Ç–≤–µ—Ç –¥–ª—è iOS/Android (Deep Link):

```json
{
  "platform": "android",
  "deliveryFormat": "deep-link",
  "protocol": "vless",
  "countryCode": "us",
  "serverLocation": "3X-UI Inbound: VLESS",
  "configLink": "vless://5e0a5e0a5e0a5e0a@3xui.example.com:443?...",
  "deepLink": "vless://5e0a5e0a5e0a5e0a@..."
}
```

## 9.4 Platform Detector - –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞?

### –ö–æ–¥ (src/services/platformDetector.js):

```javascript
function detectPlatform(userAgent) {
  if (/iPhone|iPad|iOS/i.test(userAgent)) return 'ios';
  if (/Android/i.test(userAgent)) return 'android';
  if (/Windows/i.test(userAgent)) return 'windows';
  if (/Mac/i.test(userAgent)) return 'macos';
  if (/Linux/i.test(userAgent)) return 'linux';
  return 'unknown';
}

function getDeliveryFormat(platform) {
  // iOS –∏ Android - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º QR Code + Deep Link
  if (['ios', 'android'].includes(platform)) return 'qr-code';
  // Desktop - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
  if (['windows', 'macos', 'linux'].includes(platform)) return 'file';
  return 'unknown';
}
```

## 9.5 –í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω—ã

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–±—Ä–∞–Ω–∞:

1. **auto** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–µ—Ä–µ—Ç –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é —Å—Ç—Ä–∞–Ω—É
2. **us** - –°–®–ê
3. **gb** - –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è
4. **de** - –ì–µ—Ä–º–∞–Ω–∏—è
5. –ò–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è —Å—Ç—Ä–∞–Ω–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞–Ω:
curl https://example.com/api/vpn/countries
```

---

# –ß–ê–°–¢–¨ 10: –ú–û–î–£–õ–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

## 10.1 –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

### **1. Platform Detector (src/services/platformDetector.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞

**–§—É–Ω–∫—Ü–∏–∏:**
```javascript
detectPlatform(userAgent)      // –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç iOS, Android, Windows, Mac, Linux
getDeliveryFormat(platform)    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç: qr-code, deep-link, file
getDeepLinkScheme(protocol)    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ö–µ–º—É –¥–ª—è deep link
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** POST /api/vpn/connect

---

### **2. 3X-UI Service (src/services/x3ui.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 3X-UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN –∫–ª–∏–µ–Ω—Ç–∞–º–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
```javascript
// –°–æ–∑–¥–∞—Ç—å VPN –∫–ª–∏–µ–Ω—Ç–∞
createClient(clientEmail, country)

// –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –∫–ª–∏–µ–Ω—Ç–∞
getClientConfig(inboundId, clientEmail)

// –ü–æ–ª—É—á–∏—Ç—å inbound'—ã
getInbounds()

// –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
getStats(inboundId)

// –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
deleteClient(inboundId, clientEmail)

// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å UUID
generateUUID()
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- POST /api/vpn/connect
- GET /api/vpn/stats
- POST /api/admin/x3ui/*

---

### **3. QR Code Service (src/services/qrService.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR –∫–æ–¥–æ–≤ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤ VPN

**–§—É–Ω–∫—Ü–∏–∏:**
```javascript
// –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å QR –∫–æ–¥
generateQRCode(text)
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** Base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ QR –∫–æ–¥–∞

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- POST /api/vpn/connect (–¥–ª—è iOS –∏ Android)

---

### **4. Token Service (src/services/tokenService.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è HMAC —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–æ–≤

**–§—É–Ω–∫—Ü–∏–∏:**
```javascript
// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
generateDownloadToken(userId, subscriptionId)

// –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω
validateDownloadToken(token)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –¢–æ–∫–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã 5 –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HMAC —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ .env –∫–ª—é—á–æ–º
- –¢–æ–∫–µ–Ω—ã –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å —Ç—Ä–µ—Ç—å–µ –ª–∏—Ü–æ

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- POST /api/vpn/connect (–¥–ª—è Desktop)
- GET /api/vpn/download/:token

---

### **5. Database Service (src/database/db.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –ë–î

**–§—É–Ω–∫—Ü–∏–∏:**
```javascript
// –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
pool.query(sql, values)
```

**Connection Pool:**
- Min connections: 2
- Max connections: 20
- Idle timeout: 30 —Å–µ–∫—É–Ω–¥

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:** –í—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö

---

## 10.2 Middleware (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏)

### **1. Auth Middleware (src/middleware/auth.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
router.post('/api/vpn/connect', auth, (req, res) => {
  // req.user —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
});
```

---

### **2. Admin Auth Middleware (src/middleware/adminAuth.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```javascript
router.use(adminAuth);  // –í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–¥–º–∏–Ω –ø—Ä–∞–≤
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ù–∞–ª–∏—á–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
- `is_admin = true` –≤ –ë–î

---

### **3. X3UI Session Middleware (src/middleware/x3ui-session.js)**

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ—Å—Å–∏–∏ —Å 3X-UI

**–§—É–Ω–∫—Ü–∏–∏:**
```javascript
initX3UISession(req, res, next)     // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é
startSessionRefresh(interval)        // –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```

---

## 10.3 –ú–∞—Ä—à—Ä—É—Ç—ã (Routes)

### **1. VPN Routes (src/routes/vpn.js)**

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- POST /api/vpn/connect - –£–º–Ω–∞—è –∫–Ω–æ–ø–∫–∞ Connect
- GET /api/vpn/countries - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞–Ω
- POST /api/vpn/change-country - –°–º–µ–Ω–∞ —Å—Ç—Ä–∞–Ω—ã
- GET /api/vpn/download/:token - –°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥
- GET /api/vpn/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

### **2. Admin Routes (src/routes/admin.js)**

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:
- GET /api/admin/users - –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- GET /api/admin/subscriptions - –í—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏
- PATCH /api/admin/subscriptions/:id/renew - –ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- PATCH /api/admin/subscriptions/:id/cancel - –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- POST /api/admin/subscriptions/grant-trial - –í—ã–¥–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- GET /api/admin/countries - –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
- PATCH /api/admin/countries/:code/toggle - –í–∫–ª—é—á–∏—Ç—å/–í—ã–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–∞–Ω—É
- GET /api/admin/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- GET /api/admin/connection-logs - –õ–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

---

### **3. 3X-UI Admin Routes (src/routes/admin-x3ui.js)**

–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 3X-UI:
- POST /api/admin/x3ui/create-vpn - –°–æ–∑–¥–∞—Ç—å VPN –∫–ª–∏–µ–Ω—Ç–∞
- POST /api/admin/x3ui/revoke-vpn - –û—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø
- GET /api/admin/x3ui/user-stats/:userId - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- GET /api/admin/x3ui/all-users-status - –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- POST /api/admin/x3ui/reset-traffic - –û–±–Ω—É–ª–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫
- GET /api/admin/x3ui/inbounds-info - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ inbound'–∞—Ö
- POST /api/admin/x3ui/sync-database - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î
- POST /api/admin/x3ui/cleanup-expired - –£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏

---

# –ß–ê–°–¢–¨ 11: API –≠–ù–î–ü–û–ò–ù–¢–´

## 11.1 Health Check

### **GET /health**

–ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/health
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "status": "ok",
  "service": "Noryx Premium VPN"
}
```

---

## 11.2 Smart Connect (—É–º–Ω–∞—è –∫–Ω–æ–ø–∫–∞)

### **POST /api/vpn/connect**

–û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ VPN.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST https://example.com/api/vpn/connect \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "countryCode": "us"
  }'
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `countryCode` (string) - –ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã (us, gb, de) –∏–ª–∏ "auto"
- `userId` (number) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ JWT)

**–û—Ç–≤–µ—Ç (200 OK) - iOS:**
```json
{
  "platform": "ios",
  "deliveryFormat": "qr-code",
  "protocol": "vless",
  "countryCode": "us",
  "serverLocation": "3X-UI Inbound: VLESS",
  "qrCode": "data:image/png;base64,...",
  "configLink": "vless://uuid@host:port?..."
}
```

**–û—à–∏–±–∫–∏:**
- 400 - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- 403 - –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏
- 500 - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

### **GET /api/vpn/countries**

–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞–Ω.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/vpn/countries
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "countries": [
    {
      "country_code": "us",
      "country_name": "United States",
      "flag_emoji": "üá∫üá∏",
      "is_available": true
    },
    {
      "country_code": "gb",
      "country_name": "United Kingdom",
      "flag_emoji": "üá¨üáß",
      "is_available": true
    }
  ]
}
```

---

### **POST /api/vpn/change-country**

–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST https://example.com/api/vpn/change-country \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "countryCode": "gb"
  }'
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "success": true,
  "countryCode": "gb",
  "message": "VPN country changed to gb"
}
```

---

### **GET /api/vpn/stats**

–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/vpn/stats \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "stats": {
    "uploadTraffic": 1024000,
    "downloadTraffic": 5120000,
    "totalTraffic": 6144000,
    "uptime": 3600
  }
}
```

---

### **GET /api/vpn/download/:token**

–°–∫–∞—á–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª (—Ç–æ–ª—å–∫–æ –¥–ª—è Desktop).

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/vpn/download/TOKEN_HERE \
  -o noryx-vpn-config.conf
```

**–û—Ç–≤–µ—Ç (200 OK):**
```
Content-Type: application/octet-stream
Content-Disposition: attachment; filename="noryx-vpn-config.conf"
Body: –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
```

---

## 11.3 Admin API

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω–∞ —Å `is_admin = true`.

### **GET /api/admin/users**

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/admin/users \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
[
  {
    "id": 1,
    "email": "user@example.com",
    "created_at": "2024-01-01T10:00:00Z",
    "total_subscriptions": 2,
    "active_subscriptions": 1
  }
]
```

---

### **GET /api/admin/subscriptions**

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/admin/subscriptions \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
[
  {
    "id": 1,
    "user_id": 1,
    "email": "user@example.com",
    "plan_type": "premium",
    "status": "active",
    "started_at": "2024-01-01T10:00:00Z",
    "expires_at": "2024-02-01T10:00:00Z",
    "created_at": "2024-01-01T10:00:00Z"
  }
]
```

---

### **PATCH /api/admin/subscriptions/:id/renew**

–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X PATCH https://example.com/api/admin/subscriptions/1/renew \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "days": 30
  }'
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "message": "Subscription renewed",
  "subscription": {
    "id": 1,
    "status": "active",
    "expires_at": "2024-02-01T10:00:00Z"
  }
}
```

---

### **PATCH /api/admin/subscriptions/:id/cancel**

–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X PATCH https://example.com/api/admin/subscriptions/1/cancel \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "message": "Subscription cancelled",
  "subscription": {
    "id": 1,
    "status": "cancelled"
  }
}
```

---

### **POST /api/admin/subscriptions/grant-trial**

–í—ã–¥–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X POST https://example.com/api/admin/subscriptions/grant-trial \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "userId": 1,
    "days": 7
  }'
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "message": "Trial granted",
  "subscription": {
    "id": 2,
    "user_id": 1,
    "plan_type": "trial",
    "status": "active",
    "expires_at": "2024-01-08T10:00:00Z"
  }
}
```

---

### **GET /api/admin/countries**

–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω—ã.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/admin/countries \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
[
  {
    "id": 1,
    "country_code": "us",
    "country_name": "United States",
    "flag_emoji": "üá∫üá∏",
    "is_available": true,
    "priority": 10
  }
]
```

---

### **PATCH /api/admin/countries/:code/toggle**

–í–∫–ª—é—á–∏—Ç—å/–í—ã–∫–ª—é—á–∏—Ç—å —Å—Ç—Ä–∞–Ω—É.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl -X PATCH https://example.com/api/admin/countries/us/toggle \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "message": "Country status toggled",
  "country": {
    "country_code": "us",
    "is_available": false
  }
}
```

---

### **GET /api/admin/stats**

–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/admin/stats \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "totalUsers": 150,
  "activeSubscriptions": 89,
  "connectionsLast24h": 450,
  "topCountries": [
    { "country_code": "us", "count": 120 },
    { "country_code": "gb", "count": 85 }
  ],
  "platforms": [
    { "platform": "ios", "count": 200 },
    { "platform": "android", "count": 150 },
    { "platform": "windows", "count": 100 }
  ]
}
```

---

### **GET /api/admin/connection-logs**

–ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π.

**–ó–∞–ø—Ä–æ—Å:**
```bash
curl https://example.com/api/admin/connection-logs?limit=50 \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN"
```

**–û—Ç–≤–µ—Ç (200 OK):**
```json
[
  {
    "id": 1,
    "user_id": 1,
    "email": "user@example.com",
    "platform": "ios",
    "connection_type": "qr-code",
    "country_code": "us",
    "connected_at": "2024-01-01T10:00:00Z"
  }
]
```

---

# –ß–ê–°–¢–¨ 12: –ú–û–ù–ò–¢–û–†–ò–ù–ì

## 12.1 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –°—Ç–∞—Ç—É—Å PM2

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs noryx

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —Å—Ç—Ä–æ–∫)
pm2 logs noryx --lines 200 --err

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä
pm2 monit
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

```bash
# –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
pm2 info noryx

# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã PM2
pm2 list
```

---

## 12.2 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Nginx

### –õ–æ–≥–∏ Nginx

```bash
# Access –ª–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫)
sudo tail -f /var/log/nginx/noryx_access.log

# Error –ª–æ–≥–∏
sudo tail -f /var/log/nginx/noryx_error.log

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–¥–∞–º –æ—Ç–≤–µ—Ç–æ–≤
sudo tail -f /var/log/nginx/noryx_access.log | grep -oE '"[^"]*" [0-9]{3}' | sort | uniq -c | sort -rn
```

---

## 12.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PostgreSQL

### –°—Ç–∞—Ç—É—Å –ë–î

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PostgreSQL
sudo systemctl status postgresql

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä
psql -U noryx_admin -d noryx_vpn -c "SELECT pg_size_pretty(pg_database_size('noryx_vpn'));"

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
psql -U noryx_admin -d noryx_vpn -c "SELECT COUNT(*) as total_users FROM users;"

# –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
psql -U noryx_admin -d noryx_vpn -c "SELECT COUNT(*) as active_subscriptions FROM subscriptions WHERE status = 'active' AND expires_at > NOW();"

# –†–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü
psql -U noryx_admin -d noryx_vpn -c "SELECT schemaname, tablename, pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size FROM pg_tables WHERE schemaname != 'pg_catalog' ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;"
```

---

## 12.4 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏ (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
top

# –ë—ã—Å—Ç—Ä—ã–π —Å–Ω–∏–º–æ–∫
free -h          # –ü–∞–º—è—Ç—å
df -h             # –î–∏—Å–∫
ps aux | grep -E 'node|nginx|postgres'

# –ó–∞–Ω—è—Ç—ã–µ –ø–æ—Ä—Ç—ã
sudo ss -tlnp

# –°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
netstat -a | grep ESTABLISHED
```

---

## 12.5 –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è

### –ß—Ç–æ –Ω—É–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ò–¥–µ–∞–ª—å–Ω–æ | –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ | –û–ø–∞—Å–Ω–æ—Å—Ç—å |
|---------|----------|----------------|-----------|
| CPU Usage | 5-20% | > 50% | > 80% |
| RAM Usage | < 60% | > 75% | > 90% |
| Disk Usage | < 50% | > 80% | > 95% |
| HTTP 5xx errors | 0% | > 1% | > 5% |
| API Response Time | < 200ms | > 500ms | > 2000ms |
| DB Connections | < 10 | > 15 | > 20 |
| Connection Logs/Hour | –ü–æ –ø–ª–∞–Ω—É | 2x –±–æ–ª—å—à–µ | 5x –±–æ–ª—å—à–µ |

---

# –ß–ê–°–¢–¨ 13: –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

## 13.1 Firewall

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UFW

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo ufw status verbose

# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ—Ä—Ç—ã
sudo ufw allow 22/tcp      # SSH
sudo ufw allow 80/tcp      # HTTP
sudo ufw allow 443/tcp     # HTTPS

# –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
sudo ufw default deny incoming

# –í–∫–ª—é—á–∏—Ç—å firewall
sudo ufw enable

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞
sudo ufw show added
```

---

## 13.2 SSH Security

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH

```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥
sudo nano /etc/ssh/sshd_config

# –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
Port 22                          # –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –¥—Ä—É–≥–æ–π
PermitRootLogin no              # –ó–∞–ø—Ä–µ—Ç–∏—Ç—å root –ª–æ–≥–∏–Ω
PasswordAuthentication no        # –¢–æ–ª—å–∫–æ –∫–ª—é—á–∏
PubkeyAuthentication yes         # –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏
X11Forwarding no                # –û—Ç–∫–ª—é—á–∏—Ç—å X11
MaxAuthTries 3                  # –ú–∞–∫—Å –ø–æ–ø—ã—Ç–æ–∫
ClientAliveInterval 300         # Timeout 5 –º–∏–Ω
PermitEmptyPasswords no         # –ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –ø—É—Å—Ç—ã–µ –ø–∞—Ä–æ–ª–∏

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
sudo sshd -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å SSH
sudo systemctl restart sshd
```

---

## 13.3 –ó–∞—â–∏—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### Rate Limiting

–í—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (src/server.js):

```javascript
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,  // 15 –º–∏–Ω—É—Ç
  max: 100,                   // 100 –∑–∞–ø—Ä–æ—Å–æ–≤
});
```

### CORS

–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ .env:

```env
ALLOWED_ORIGINS=https://example.com,https://app.example.com
```

### Security Headers

–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ Nginx:

```nginx
add_header Strict-Transport-Security "max-age=31536000" always;
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
```

---

## 13.4 –ó–∞—â–∏—Ç–∞ –ë–î

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è backup
sudo mkdir -p /opt/backups
sudo chown $USER:$USER /opt/backups

# –†—É—á–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
pg_dump -U noryx_admin noryx_vpn > /opt/backups/noryx_$(date +%Y%m%d_%H%M%S).sql

# –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
gzip /opt/backups/noryx_*.sql

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (cron)
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2 AM):
0 2 * * * pg_dump -U noryx_admin noryx_vpn | gzip > /opt/backups/noryx_$(date +\%Y\%m\%d).sql.gz

# –ß–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö backup'–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
0 3 * * * find /opt/backups -name "noryx_*.sql.gz" -mtime +30 -delete
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î
gunzip < /opt/backups/noryx_20240101.sql.gz | psql -U noryx_admin noryx_vpn

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
psql -U noryx_admin noryx_vpn -c "SELECT COUNT(*) FROM users;"
```

---

## 13.5 –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS

### Fail2ban

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ fail2ban
sudo apt-get install -y fail2ban

# –í–∫–ª—é—á–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
sudo systemctl enable fail2ban
sudo systemctl start fail2ban

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo fail2ban-client status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–Ω–∞ –ø–æ IP
sudo fail2ban-client status sshd
```

---

## 13.6 –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ unattended-upgrades
sudo apt-get install -y unattended-upgrades

# –í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
sudo dpkg-reconfigure -plow unattended-upgrades

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥
cat /etc/apt/apt.conf.d/50unattended-upgrades
```

### –†—É—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt-get update && sudo apt-get upgrade -y

# –û–±–Ω–æ–≤–∏—Ç–µ npm –ø–∞–∫–µ—Ç—ã
cd /opt/noryx-vpn
npm outdated    # –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å
npm update      # –û–±–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart noryx
```

---

# –ß–ê–°–¢–¨ 14: –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

## 14.1 –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ PM2
pm2 logs noryx --err

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
pm2 status

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart noryx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .env –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
cat /opt/noryx-vpn/.env | grep -E "^[A-Z_]="

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ë–î –¥–æ—Å—Ç—É–ø–Ω–∞
psql -U noryx_admin -d noryx_vpn -c "SELECT 1;"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω
sudo ss -tlnp | grep 3000
```

---

## 14.2 Nginx –æ—à–∏–±–∫–∞ 502 Bad Gateway

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
pm2 status

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ 127.0.0.1:3000
sudo ss -tlnp | grep 3000

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
pm2 start /opt/noryx-vpn/src/server.js --name noryx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Nginx

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ error –ª–æ–≥–∏
sudo tail -f /var/log/nginx/noryx_error.log

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Nginx
sudo nginx -t

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx
sudo systemctl reload nginx
```

---

## 14.3 SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –µ—Å—Ç—å
sudo ls -la /etc/letsencrypt/live/example.com/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è
sudo certbot certificates

# –û–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—Ä—É—á–Ω—É—é
sudo certbot renew --force-renewal

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ auto-renewal —Ä–∞–±–æ—Ç–∞–µ—Ç
sudo systemctl status certbot.timer
```

---

## 14.4 –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –æ—à–∏–±–∫–∏ –ë–î

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

```bash
# –†–∞–∑–º–µ—Ä –ë–î
psql -U noryx_admin -d noryx_vpn -c "SELECT pg_size_pretty(pg_database_size('noryx_vpn'));"

# –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
psql -U noryx_admin -d noryx_vpn -c "SELECT datname, count(*) FROM pg_stat_activity GROUP BY datname;"

# –î–æ–ª–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã
psql -U noryx_admin -d noryx_vpn -c "SELECT query, query_start FROM pg_stat_activity WHERE query_start < now() - interval '10 minutes';"

# –û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (–µ—Å–ª–∏ –ë–î –±–æ–ª—å—à–∞—è)
psql -U noryx_admin -d noryx_vpn -c "DELETE FROM connection_logs WHERE connected_at < NOW() - INTERVAL '60 days';"

# –í–∞–∫—É—É–º–∏—Ä—É–π—Ç–µ –ë–î
psql -U noryx_admin -d noryx_vpn -c "VACUUM ANALYZE;"
```

---

## 14.5 –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
free -h

# –ö–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –ø–∞–º—è—Ç–∏
ps aux --sort=-%mem | head

# –ï—Å–ª–∏ Node.js –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –º–Ω–æ–≥–æ:
pm2 restart noryx

# –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ .env
NODE_OPTIONS=--max-old-space-size=2048
```

---

## 14.6 –ü—Ä–æ–±–ª–µ–º—ã —Å 3X-UI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ X3UI_API_URL –¥–æ—Å—Ç—É–ø–µ–Ω
curl -k https://3xui.example.com:2053/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã
# –í .env: X3UI_USERNAME –∏ X3UI_PASSWORD

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs noryx | grep -i "3xui\|inbound"

# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é –≤ 3X-UI –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ
```

---

## 14.7 –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
echo "=== SYSTEM ===" && \
echo "CPU Cores: $(nproc)" && \
echo "Memory: $(free -h | grep Mem | awk '{print $2}' )" && \
echo "Disk: $(df -h / | tail -1)" && \
echo "" && \
echo "=== SERVICES ===" && \
sudo systemctl status nginx | grep Active && \
sudo systemctl status postgresql | grep Active && \
pm2 status && \
echo "" && \
echo "=== PORTS ===" && \
sudo ss -tlnp | grep -E ':80|:443|:3000|:5432' && \
echo "" && \
echo "=== DATABASE ===" && \
psql -U noryx_admin -d noryx_vpn -c "SELECT COUNT(*) as users FROM users; SELECT COUNT(*) as subscriptions FROM subscriptions; SELECT pg_size_pretty(pg_database_size('noryx_vpn'));"
```

---

# –§–ò–ù–ê–õ–¨–ù–ê–Ø –ß–ï–ö–õ–ò–°–¢

```
–ü–û–î–ì–û–¢–û–í–ö–ê –°–ï–†–í–ï–†–ê:
‚òê Ubuntu 22.04 / Debian 12 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
‚òê SSH –¥–æ—Å—Ç—É–ø–µ–Ω
‚òê UFW firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω (80, 443, 22)

–ó–ê–í–ò–°–ò–ú–û–°–¢–ò:
‚òê Node.js 20+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚òê PostgreSQL 15+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚òê Nginx —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚òê PM2 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚òê Certbot —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–ë–ê–ó–ê –î–ê–ù–ù–´–•:
‚òê –ë–î noryx_vpn —Å–æ–∑–¥–∞–Ω–∞
‚òê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å noryx_admin —Å–æ–∑–¥–∞–Ω
‚òê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü–†–ò–õ–û–ñ–ï–ù–ò–ï:
‚òê –ö–æ–¥ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –≤ /opt/noryx-vpn
‚òê npm install –≤—ã–ø–æ–ª–Ω–µ–Ω
‚òê .env —Ñ–∞–π–ª –∑–∞–ø–æ–ª–Ω–µ–Ω (—Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ JWT –∏ HMAC –∫–ª—é—á–∞–º–∏)
‚òê npm run build –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
‚òê npm run init-db –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
‚òê –¢–∞–±–ª–∏—Ü—ã –≤ –ë–î —Å–æ–∑–¥–∞–Ω—ã

NGINX –ò SSL:
‚òê Nginx –∫–æ–Ω—Ñ–∏–≥ —Å–æ–∑–¥–∞–Ω –∏ –≤–∫–ª—é—á–µ–Ω
‚òê SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª—É—á–µ–Ω –æ—Ç Let's Encrypt
‚òê HTTPS —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

–ü–†–ò–õ–û–ñ–ï–ù–ò–ï –í PRODUCTION:
‚òê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ —á–µ—Ä–µ–∑ PM2
‚òê PM2 –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
‚òê –ü—Ä–æ–≤–µ—Ä–µ–Ω /health —ç–Ω–¥–ø–æ–∏–Ω—Ç
‚òê –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ /admin.html
‚òê API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–≤–µ—á–∞—é—Ç

–ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨:
‚òê –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –ë–î –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
‚òê Fail2ban —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –≤–∫–ª—é—á–µ–Ω
‚òê –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ
‚òê Auto-renewal —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤–∫–ª—é—á–µ–Ω

–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:
‚òê curl https://example.com/health —Ä–∞–±–æ—Ç–∞–µ—Ç
‚òê –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
‚òê HTTPS –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
‚òê API /api/vpn/countries –æ—Ç–≤–µ—á–∞–µ—Ç
‚òê –ë–î —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–µ–±–µ)

```bash
# –°–¢–ê–†–¢/–°–¢–û–ü –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 start /opt/noryx-vpn/src/server.js --name noryx
pm2 stop noryx
pm2 restart noryx
pm2 delete noryx

# –õ–û–ì–ò
pm2 logs noryx --lines 100
tail -f /var/log/nginx/noryx_access.log
tail -f /var/log/nginx/noryx_error.log

# –ü–†–û–í–ï–†–ö–ê –ü–û–†–¢–û–í
sudo ss -tlnp | grep -E ':(80|443|3000|5432)'

# –ü–†–û–í–ï–†–ö–ê –ë–î
psql -U noryx_admin -d noryx_vpn -c "SELECT 1;"
psql -U noryx_admin -d noryx_vpn -c "SELECT COUNT(*) FROM users;"

# –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
cd /opt/noryx-vpn && git pull && npm install && pm2 restart noryx

# –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ê NGINX
sudo systemctl reload nginx
sudo systemctl restart nginx

# –ü–†–û–í–ï–†–ö–ê SSL
sudo certbot certificates

# –ë–≠–ö–ê–ü –ë–î
pg_dump -U noryx_admin noryx_vpn | gzip > /opt/backups/noryx_$(date +%Y%m%d).sql.gz

# –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ë–î
gunzip < /opt/backups/noryx_YYYYMMDD.sql.gz | psql -U noryx_admin noryx_vpn
```

---

**–î–æ–∫—É–º–µ–Ω—Ç –∞–∫—Ç—É–∞–ª–µ–Ω: 2024 –≥–æ–¥**
**–í–µ—Ä—Å–∏—è: 1.0 Complete**
**–ê–≤—Ç–æ—Ä: Noryx Premium VPN Team**

–ü—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–ß–ê–°–¢–¨ 14: –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú" –≤ —ç—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ.
