<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–∞—Ä–∏—Ñ—ã - NoryxVPN</title>
  <link rel="stylesheet" href="/assets/styles.css">
</head>
<body>
  <header>
    <div class="header-content">
      <a href="/" class="logo">NoryxVPN</a>
      <button class="mobile-menu-toggle" onclick="document.querySelector('nav').classList.toggle('open')">&#9776;</button>
      <nav>
        <ul>
          <li><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="/tariffs" class="active">–¢–∞—Ä–∏—Ñ—ã</a></li>
          <li><a href="/servers">–°–µ—Ä–≤–µ—Ä—ã</a></li>
          <li><a href="/apps">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</a></li>
          <li><a href="/support">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a></li>
          <li data-auth="guest"><a href="/login" class="btn btn-primary btn-sm">–í–æ–π—Ç–∏</a></li>
          <li data-auth="user" style="display:none"><a href="/cabinet" class="btn btn-primary btn-sm">–ö–∞–±–∏–Ω–µ—Ç</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="hero" style="padding:3rem 2rem 2.5rem;">
    <div class="hero-content">
      <h1 style="background: linear-gradient(135deg, #00F2FF 0%, #0AC8D9 50%, #00F2FF 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã</h1>
      <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω. –ë–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π, –ø–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å.</p>
    </div>
  </section>

  <div class="container">
    <div class="tab-nav" style="justify-content:center;">
      <button class="tab-btn active" onclick="switchPeriod(this,'monthly')">1 –º–µ—Å—è—Ü</button>
      <button class="tab-btn" onclick="switchPeriod(this,'quarterly')">3 –º–µ—Å—è—Ü–∞</button>
      <button class="tab-btn" onclick="switchPeriod(this,'yearly')">1 –≥–æ–¥</button>
    </div>

    <div id="tariffsGrid" class="pricing-grid">
      <div class="loading-spinner" style="grid-column:1/-1;"><div class="spinner"></div></div>
    </div>

    <div style="text-align:center;margin-top:4rem;padding:2.5rem;background:rgba(22,22,24,0.6);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-radius:var(--radius-lg);border:1px solid rgba(42,42,45,0.5);box-shadow:0 8px 32px rgba(0,242,255,0.05),inset 0 1px 0 rgba(255,255,255,0.05);">
      <h2 style="margin-bottom:1rem;background: linear-gradient(135deg, #00F2FF 0%, #0AC8D9 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">–í–∫–ª—é—á–µ–Ω–æ –≤–æ –≤—Å–µ —Ç–∞—Ä–∏—Ñ—ã</h2>
      <div class="cards-grid" style="margin-top:1.5rem;text-align:left;">
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">‚ö°</div><h4 style="font-size:1rem;color:var(--primary);">–ü—Ä–æ—Ç–æ–∫–æ–ª VLESS</h4><p>–£–ª—å—Ç—Ä–∞–ª—ë–≥–∫–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è</p></div>
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">üåç</div><h4 style="font-size:1rem;color:var(--primary);">–í—Å–µ —Å–µ—Ä–≤–µ—Ä—ã</h4><p>–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–π –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏</p></div>
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">üîß</div><h4 style="font-size:1rem;color:var(--primary);">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7</h4><p>–ü–æ–º–æ—â—å –≤ Telegram –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –¥–Ω—è –∏ –Ω–æ—á–∏</p></div>
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">üõ°Ô∏è</div><h4 style="font-size:1rem;color:var(--primary);">–í–æ–µ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h4><p>AES-256 –∑–∞—â–∏—Ç–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</p></div>
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">üöÄ</div><h4 style="font-size:1rem;color:var(--primary);">–ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</h4><p>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</p></div>
        <div class="card" style="border:none;background:transparent;"><div style="font-size:1.5rem;margin-bottom:0.5rem;">üîê</div><h4 style="font-size:1rem;color:var(--primary);">–ù—É–ª–µ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</h4><p>–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</p></div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section"><h4>NoryxVPN</h4><p style="color:var(--text-muted);">–ë—ã—Å—Ç—Ä—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π VPN.</p></div>
      <div class="footer-section"><h4>–ü—Ä–æ–¥—É–∫—Ç</h4><ul><li><a href="/tariffs">–¢–∞—Ä–∏—Ñ—ã</a></li><li><a href="/servers">–°–µ—Ä–≤–µ—Ä—ã</a></li><li><a href="/apps">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</a></li></ul></div>
      <div class="footer-section"><h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4><ul><li><a href="https://t.me/NoryxWebBot" target="_blank">Telegram –±–æ—Ç</a></li></ul></div>
    </div>
    <div class="footer-bottom"><p>NoryxVPN. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p></div>
  </footer>

  <script src="/assets/app.js"></script>
  <script>
    var allTariffs = [];
    var currentPeriod = 'monthly';

    var periodLabels = {
      monthly: '/ –º–µ—Å.',
      quarterly: '/ 3 –º–µ—Å.',
      yearly: '/ –≥–æ–¥'
    };

    var priceFields = {
      monthly: 'price_monthly',
      quarterly: 'price_quarterly',
      yearly: 'price_yearly'
    };

    async function loadTariffs() {
      try {
        allTariffs = await API.get('/api/tariffs');
        renderTariffs();
      } catch (err) {
        document.getElementById('tariffsGrid').innerHTML = '<div class="empty-state" style="grid-column:1/-1;"><p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã</p></div>';
      }
    }

    function switchPeriod(btn, period) {
      document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
      btn.classList.add('active');
      currentPeriod = period;
      renderTariffs();
    }

    function renderTariffs() {
      var grid = document.getElementById('tariffsGrid');
      var filtered = allTariffs.filter(function(t) { return !t.is_trial; });

      if (filtered.length === 0) {
        grid.innerHTML = '<div class="empty-state" style="grid-column:1/-1;"><p>–ù–µ—Ç —Ç–∞—Ä–∏—Ñ–æ–≤</p></div>';
        return;
      }

      var mid = Math.floor(filtered.length / 2);
      grid.innerHTML = filtered.map(function(t, i) {
        var isFeatured = i === mid && filtered.length > 1;
        var features = Array.isArray(t.features) ? t.features : [];
        var price = Number(t[priceFields[currentPeriod]]) || 0;
        var priceText = price + '<span class="price-period"> &#8381;</span>';
        var periodText = periodLabels[currentPeriod];

        return '<div class="pricing-card' + (isFeatured ? ' featured" data-badge="–ü–æ–ø—É–ª—è—Ä–Ω—ã–π"' : '"') + '>' +
          '<h3>' + t.name + '</h3>' +
          '<p style="color:var(--text-muted);font-size:0.85rem;">' + (t.description || '') + '</p>' +
          '<div class="price">' + priceText + '</div>' +
          '<div style="color:var(--text-muted);font-size:0.85rem;margin-bottom:1rem;">' + periodText + '</div>' +
          '<ul class="features-list">' + features.map(function(f) { return '<li>' + f + '</li>'; }).join('') + '</ul>' +
          '<button class="btn ' + (isFeatured ? 'btn-primary' : 'btn-secondary') + ' btn-block" onclick="purchaseTariff(\'' + t.id + '\')">–ö—É–ø–∏—Ç—å</button>' +
        '</div>';
      }).join('');
    }

    async function purchaseTariff(tariffId) {
      if (!Auth.isLoggedIn()) {
        window.location.href = '/register';
        return;
      }
      try {
        var result = await API.post('/api/subscriptions/purchase', { tariff_id: tariffId, period: currentPeriod });
        showToast('–ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!', 'success');
        setTimeout(function() { window.location.href = '/cabinet'; }, 1000);
      } catch (err) {
        showToast(err.message, 'error');
      }
    }

    document.addEventListener('DOMContentLoaded', loadTariffs);
  </script>
</body>
</html>
